# aiogram-bot
Telegram бот для управления товарами

Бот построен на основе библиотеки aiogram для создания Telegram-ботов на Python. Основная функциональность бота связана с управлением продуктами, категориями, фотогалереей и взаимодействием с пользователями. Давайте разберем основные компоненты и их функциональность:

1. Основные файлы и их назначение:
main.py: Это главный файл, который запускает бота. В нем регистрируются все роутеры (обработчики команд и сообщений) и запускается процесс опроса серверов Telegram для получения обновлений (dp.run_polling(bot)).

config.py: Этот файл отвечает за загрузку конфигурации бота, такой как токен бота и ID администратора. Конфигурация загружается из переменных окружения с помощью библиотеки environs.

loader.py: В этом файле происходит инициализация бота и диспетчера (Dispatcher). Также здесь определены функции on_startup и on_shutdown, которые выполняются при запуске и завершении работы бота соответственно.

echo.py: Этот файл содержит обработчик для всех сообщений, которые не были обработаны другими роутерами. Он просто удаляет сообщение пользователя.

ikb.py: Этот файл отвечает за создание инлайн-клавиатур (InlineKeyboardMarkup) для взаимодействия с пользователем. Клавиатуры могут быть динамическими, в зависимости от состояния бота или выбора пользователя.

sql_users.py: Этот файл содержит класс BotDatabase, который управляет базой данных SQLite для хранения информации о пользователях. В базе данных хранятся такие данные, как ID пользователя, имя, статус администратора, количество перезапусков бота и т.д.

start.py: Этот файл содержит обработчик команды /start, который запускается при первом взаимодействии пользователя с ботом. Он регистрирует пользователя в базе данных, отправляет приветственное сообщение и показывает информацию о доступных товарах.

functions.py: Этот файл содержит вспомогательные функции, такие как обработка фотографий, получение курса валют, форматирование даты и времени, а также функции для работы с состоянием бота (FSMContext).

2. Основная функциональность бота:
Регистрация пользователей: При первом запуске бота пользователь регистрируется в базе данных. Если пользователь уже зарегистрирован, бот просто обновляет его данные.

Управление продуктами: Бот позволяет пользователям просматривать продукты, их категории, цены и доступные размеры. Информация о продуктах хранится в базе данных, и бот может динамически формировать сообщения с фотографиями и описаниями товаров.

Инлайн-клавиатуры: Бот активно использует инлайн-клавиатуры для навигации по категориям товаров, фильтрации по размерам и другим параметрам. Клавиатуры создаются динамически в зависимости от выбора пользователя.

Работа с состоянием (FSM): Бот использует конечные автоматы (Finite State Machine, FSM) для управления состоянием пользователя. Это позволяет боту запоминать текущий контекст взаимодействия с пользователем (например, просмотр определенной категории товаров или фильтрация по размеру).

Получение курса валют: Бот получает актуальный курс доллара и евро с сайта Национального банка Украины и использует его для отображения цен в гривнах.

Управление фотогалереей: Бот может показывать фотографии товаров, а также управлять галереей, позволяя пользователю листать фотографии и добавлять товары в избранное.

3. Особенности реализации:
Использование SQLite: Бот использует SQLite для хранения данных о пользователях и продуктах. Это легковесная база данных, которая хорошо подходит для небольших проектов.

Асинхронность: Бот написан с использованием асинхронного программирования, что позволяет ему эффективно обрабатывать множество запросов одновременно.

Динамическое формирование сообщений: Бот динамически формирует сообщения с информацией о товарах, используя данные из базы данных. Это позволяет легко обновлять информацию о товарах без изменения кода бота.

Обработка ошибок: В коде есть обработка ошибок, таких как TelegramBadRequest, что позволяет боту корректно работать даже в случае возникновения проблем с API Telegram.

4. Рекомендации по улучшению:
Логирование: В коде закомментированы строки, связанные с логированием. Рекомендуется добавить логирование для упрощения отладки и мониторинга работы бота.

Масштабируемость: Если бот будет расти, возможно, стоит рассмотреть переход на более мощную базу данных, такую как PostgreSQL, и использование ORM (например, SQLAlchemy) для упрощения работы с данными.

Документация: Добавление комментариев и документации к коду поможет другим разработчикам (или вам в будущем) быстрее разобраться в логике работы бота.

5. Ссылка на бота:
https://t.me/cholovichyi_odiah_bot

Этот бот представляет собой полноценное решение для управления каталогом товаров и взаимодействия с пользователями в Telegram. Он хорошо структурирован и готов к дальнейшему расширению функциональности.
